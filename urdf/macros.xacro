<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="new_bcr_robot">

<!--................................ INERTIA MATRICES .............................. -->

  <xacro:macro name="cylinder_inertia" params="m r h">
    <inertia ixx="${m * (3 * r * r + h * h) / 12}" ixy="0" ixz="0"
      iyy="${m * (3 * r * r + h * h) / 12}" iyz="0"
      izz="${m * r * r / 2}"
    />
  </xacro:macro>

  <xacro:macro name="box_inertia" params="m x y z">
    <inertia ixx="${m * (y * y + z * z) / 12}" ixy="0" ixz="0"
      iyy="${m * (x * x + z * z) / 12}" iyz="0"
      izz="${m * (x * x + z * z) / 12}"
    />
  </xacro:macro>

  <xacro:macro name="sphere_inertia" params="m r">
    <inertia ixx="${2 * m * r * r / 5}" ixy="0" ixz="0"
      iyy="${2 * m * r * r / 5}" iyz="0"
      izz="${2 * m * r * r / 5}"
    />
  </xacro:macro>

<!-- ............................... WHEEL DEFINITION .............................. -->

 <xacro:macro name="wheel" params="cardinality dexterity origin_x origin_y origin_z">

   <link name="${cardinality}_${dexterity}_wheel">
    <collision>
      <origin xyz="0 0 0" rpy="0 ${pi/2} ${pi/2}" />
      <geometry>
       <cylinder length="${wheel_width}" radius="${wheel_radius}"/>
      </geometry>
    </collision>

    <visual>
      <origin xyz="0 0 0" rpy="0 ${pi/2} ${pi/2}" />
      <geometry>
       <cylinder length="${wheel_width}" radius="${wheel_radius}"/>
      </geometry>
      <material name="black"/>
    </visual>

    <inertial>
      <origin xyz="0 0 0" rpy="0 ${pi/2} ${pi/2}" />

    <xacro:if value="${cardinality == 'middle'}">
        <mass value="${traction_wheel_mass}"/>
				<xacro:cylinder_inertia m="${traction_wheel_mass}" r="${wheel_radius}" h="${wheel_width}"/>
    </xacro:if>

    <xacro:unless value="${cardinality == 'middle'}">
        <mass value="${trolley_wheel_mass}"/>
				<xacro:cylinder_inertia m="${trolley_wheel_mass}" r="${wheel_radius}" h="${wheel_width}"/>
    </xacro:unless>


    </inertial>
   </link>

   <joint name="${cardinality}_${dexterity}_wheel_joint" type="continuous">
      <parent link="base_link"/>
      <child link="${cardinality}_${dexterity}_wheel"/>
      <origin xyz="${origin_x} ${origin_y} ${origin_z}" rpy="0 0 0" />
      <axis xyz="0 1 0" rpy="0 0 0" />
    </joint>

   <gazebo reference="${cardinality}_${dexterity}_wheel">
      <material>Gazebo/Black</material>
   </gazebo>

  </xacro:macro>

</robot>
